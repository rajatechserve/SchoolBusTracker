
import React, { useEffect, useState } from 'react';
import api from '../services/api';
export default function Assignments(){ const [drivers,setDrivers]=useState([]); const [buses,setBuses]=useState([]); const [routes,setRoutes]=useState([]); const [list,setList]=useState([]); const [form,setForm]=useState({driverId:'',busId:'',routeId:''});
useEffect(()=>{ api.get('/drivers').then(r=>setDrivers(r.data||[])); api.get('/buses').then(r=>setBuses(r.data||[])); api.get('/routes').then(r=>setRoutes(r.data||[])); api.get('/assignments').then(r=>setList(r.data||[])); },[]);
const save=async()=>{ try{ await api.post('/assignments', form); const r=await api.get('/assignments'); setList(r.data||[]); }catch(e){alert('Error');} };
const remove=async(id)=>{ if(!confirm('Delete?')) return; await api.delete('/assignments/'+id); const r=await api.get('/assignments'); setList(r.data||[]); };
return (<div><h2 className='text-xl font-semibold mb-4'>Assignments</h2><div className='mb-4'><select value={form.driverId} onChange={e=>setForm({...form,driverId:e.target.value})} className='border p-2 mr-2'><option value=''>Select driver</option>{drivers.map(d=>(<option key={d.id} value={d.id}>{d.name}</option>))}</select><select value={form.busId} onChange={e=>setForm({...form,busId:e.target.value})} className='border p-2 mr-2'><option value=''>Select bus</option>{buses.map(b=>(<option key={b.id} value={b.id}>{b.number}</option>))}</select><select value={form.routeId} onChange={e=>setForm({...form,routeId:e.target.value})} className='border p-2 mr-2'><option value=''>Select route</option>{routes.map(r=> (<option key={r.id} value={r.id}>{r.name}</option>))}</select><button onClick={save} className='btn-primary'>Assign</button></div><div className='space-y-2'>{list.map(a=>(<div key={a.id} className='p-3 bg-white rounded shadow flex justify-between items-center'><div>{a.driverId} â†’ {a.busId} / {a.routeId}</div><div><button onClick={()=>remove(a.id)} className='text-red-600'>Delete</button></div></div>))}</div></div>); }
